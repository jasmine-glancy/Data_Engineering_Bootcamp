# <img src="../books.svg" alt="Stack of red books with a graduation cap on top, symbolizing education and achievement, set against a plain background" width="30" height="20" /> Fact Data Modeling

## <img src="../notes.svg" alt="Orange pencil lying diagonally on a white sheet of paper, representing note taking and documentation, with a clean and organized appearance" width="20" height="15" /> Core Elements in Data Modeling

| Concept                | Notes            |
|---------------------|------------------|
| **Facts vs Dimensions**  | - Is it a fact or a dimension?<br> &emsp;• Did a user log in today? <br> &emsp;&emsp;• The log in event would be a fact that informs the `dim_is_active` dimension<br> &emsp;&emsp;• VS the state `dim_is_activated` which is something that is state-driven, *not* activity-driven <br> &emsp;• You can aggregate facts and turn them into dimensions <br> &emsp;&emsp;• Is this person a "high engager"? A "low engager"? <br> &emsp;&emsp;&emsp;• Think scoring class from Week 1<br> &emsp;&emsp;• Using `CASE WHEN()` to bucketize aggregated facts can be very useful to reduce the cardinality <br> &emsp;&emsp;&emsp;• If you have extremely high cardinality, the data will look strange <br> &emsp;&emsp;&emsp;• Users should not be in a bucket by themselves if possible because otherwise you can't get the normality assumption in your data<br> &emsp;&emsp;&emsp;• 5-10 buckets is the "sweet spot" of ranges<br> &emsp;&emsp;&emsp;&emsp;• How you bucketize should be informed by statistical distribution <br> &emsp;&emsp;&emsp;• Include comments where the bucket values are so they can be changed if folks don't like them |
| **Properties of Facts vs Dimensions**  | - **Dimensions:** <br> &emsp;• Usually show up in `GROUP BY` when doing analytics <br> &emsp;&emsp;• i.e. they are the things you *group on*<br> &emsp;• Can be "high cardinality" or "low cardinality" depending<br> &emsp;• Generally come from a snapshot of state <br> &emsp;&emsp;• i.e. a snapshot of the production database at a moment in time<br>- **Facts** <br> &emsp;• Usually aggregated when doing analytics by things like `SUM`, `AVG`, and `COUNT`<br> &emsp;• Almost always higher volume than dimensions, although some fact sources are low-volume <br> &emsp;&emsp;• Think "rare events"<br> &emsp;• Generally come from events and logs<br>-***A fact has to be logged, while a dimension comes from the state of things***|
| **Boolean/Existence-based Facts and Dimensions**  | - `dim_is_active`, `dim_bought_something`, etc <br> &emsp;• These are usually on the daily/hour grain, too <br>- `dim_has_ever_booked`, `dim_ever_active`, `dim_ever_labeled_fake` <br> &emsp;• These "ever" dimensions look to see if there has "ever" been a log <br> &emsp;&emsp;•  Once the above columns flipped one way, they never went back <br> &emsp;&emsp;• You can have flags that can flip back (i.e. `dim_monthly_is_active`)<br> &emsp;• Interesting, simple, and powerful features for machine learning <br> &emsp;&emsp;• An Airbnb host with active listing who has never been booked looks sketchier over time <br>- "Days since" dimensions <br> &emsp;• e.g. `days_since_last_active`, `days_since_signup`, etc<br> &emsp;&emsp;• Very common in retention analytical patterns <br> &emsp;&emsp;• [**J curves**](https://github.com/jasmine-glancy/Data_Engineering_Bootcamp/blob/main/Notes/Module%205/Applying_Analytical_Patterns_Lab.md) - i.e. everyone who signed up for the app initially and the percent of users who are left over after x amount of time<br> &emsp;&emsp;&emsp;• Called this because the line looks like a "J"|
| **Categorical Facts and Dimensions**  | - [The `scoring_class` in week 1](https://github.com/jasmine-glancy/Data_Engineering_Bootcamp/blob/main/Notes/Module%201/Dimensional_Data_Modeling_Lab.md#create-scoring-class-code) <br> &emsp;• A dimension thta is derived from fact data <br>- Often calculated with `CASE WHEN` logic and "bucketizing" <br> &emsp;• Example: Airbnb Superhost <br>- When you are thinking of definitions like "availability", get as many people involved as possible in the discussion to minimize future need for changes<br> &emsp;• Changing categorical dimension definitions are expensive to change later! |
| **Using Dimensions Or Facts**  | - Should you use dimensions or facts to analyze users? <br> &emsp;• Is the `dim_is_activated` state or `dim_is_active` logs a better metric? <br> &emsp;&emsp;• Great data science question because *it depends*!<br> &emsp;• It's the dfference between "signups" and "growth" in some perspectives |
| **The Extremely Efficient Date List Data Structure**  | - Read Max Sung's writeup on this [here](https://www.linkedin.com/pulse/datelist-int-efficient-data-structure-user-growth-max-sung/) <br>- Extremely efficient way to manage user growth <br>- Imagine a cumulated schema like `users_cumulated` <br> &emsp;• uxer_id <br> &emsp;• date<br> &emsp;• dates_active - an array of all the recent days a user was active <br>- You can turn that into a structure like: <br> &emsp;• user_id, date, datelist_int <br> &emsp;• 32, 2023-01-01, 100000010000001 <br> &emsp;• Where the 1s in the integer represent the activity for 2023-01-01 - bit_position (zero indexed) <br>- You could count every user's data for the last 30 days, but that isn't very efficient depending on how many users you have <br> &emsp;• Cumulative table design can be used instead to create a new table to process 30 days  <br> &emsp;• When the next day comes in, drop the 31st day and keep everything else|

## <img src="../question-and-answer.svg" alt="Two speech bubbles, one with a large letter Q and the other with a large letter A, representing a question and answer exchange in a friendly and approachable style" width="35" height="28" /> Cues

- What distinguishes a fact from a dimension in data modeling?
- What does bucketization help achieve when modeling data dimensions?
- How can a dimension like 'Dim is active' be considered both a fact and a dimension?
- Why is the dimension definition important in long-term data modeling?
- What role does cardinality play in distinguishing between facts and dimensions?
  
---

## <img src="../summary.svg" alt="Rolled parchment scroll with visible lines, symbolizing a summary or conclusion, placed on a neutral background" width="30" height="18" /> Summary

Facts are events or actions that are logged and subsequently aggregated, while dimensions represent a snapshot of attributes or states at a specific time. Facts often have high cardinality due to the multitude of different actions or events logged, which reflects the dynamic, varied activities occurring over time. Bucketization helps in grouping similar data values into categories. This facilitates clearer analysis and prevents overly-specific categories that would hinder analysis due to high cardinality.

A dimension such as `dim_is_active` can be derived from facts (e.g. user activity events) to represent a user's state, blurring the line between an event log and a snapshot attribute. Once dimensions are established in business operations and reports, changing them can require extensive cross-departmental consensus and alterations in the data model, making it expensive and intricate.
